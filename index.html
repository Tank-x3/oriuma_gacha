<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>オリウマ ガチャシミュレーター</title>
    <link rel="stylesheet" href="style.css?v=1.3">
</head>

<body>

    <div class="main-container">
        <header>
            <h1>オリウマ ガチャ</h1>
        </header>

        <div id="info-area" class="info-banner hidden"></div>

        <div id="stats-area" class="stats-container">
        </div>

        <div id="display-area">
            <div id="gate-text-area" class="gate-text hidden"></div>
            <ul id="result-list">
                <li class="placeholder-text">「ガチャを引く」ボタンを押してください</li>
            </ul>
        </div>

        <div class="control-area">
            <!-- Group 1: Initial (Start) -->
            <div id="ctrl-init" class="control-group">
                <button id="btn-single" class="gacha-btn" onclick="pullGacha(1)">単発で引く</button>
                <button id="btn-multi" class="gacha-btn primary" onclick="pullGacha(10)">10連で引く</button>
            </div>

            <!-- Group 2: Active (Skip) -->
            <div id="ctrl-active" class="control-group hidden">
                <button id="btn-skip" class="action-btn full-width" onclick="skipAnimation()">SKIP ▶▶</button>
                <div class="skip-option-row" onclick="event.stopPropagation()">
                    <label>
                        <input type="checkbox" id="chk-skip-all"> 止まらずスキップ
                    </label>
                </div>
            </div>

            <!-- Group 3: Result (Retry/Back/Share) -->
            <div id="ctrl-result" class="control-group hidden">
                <button id="btn-retry" class="gacha-btn primary" onclick="retryGacha()">もう一度引く</button>
                <button id="btn-title" class="action-btn" onclick="backToTitle()">回数選択へ</button>
                <button id="btn-share" class="action-btn share-btn" onclick="generateImage()">📸 画像で保存</button>
            </div>
        </div>

        <div class="footer-area">
            <button class="text-link-btn" onclick="openHistory()">📜 ガチャ履歴を見る</button>
        </div>
    </div>

    <div id="history-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn" onclick="closeHistory()">&times;</span>
            <h2>ガチャ履歴 (最新100件)</h2>
            <div id="history-list" class="history-list-container">
            </div>
            <button class="clear-history-btn" onclick="clearHistory()">履歴を削除</button>
        </div>
    </div>

    <!-- Image Generation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image-more/3.3.0/dom-to-image-more.min.js"></script>

    <script src="config.js?v=1.3"></script>
    <script src="characters.js?v=1.3"></script>
    <script src="js/gacha_logic.js?v=1.4"></script>
    <script src="js/gacha_view.js?v=1.4"></script>
    <script src="js/main.js?v=1.4"></script>
</body>

</html>